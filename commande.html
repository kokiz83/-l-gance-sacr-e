<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Passer une commande</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <h2>üì¶ Passer une commande</h2>
      <form id="commandeForm">
        <label for="nom">Nom complet :</label>
        <input type="text" id="nom" placeholder="Votre nom complet" required />

        <label for="email">Email :</label>
        <input
          type="email"
          id="email"
          placeholder="exemple@domaine.com"
          required
        />

        <label for="tel">T√©l√©phone :</label>
        <input
          type="tel"
          id="tel"
          placeholder="Votre num√©ro de t√©l√©phone"
          required
        />

        <label for="adresse">Adresse de livraison :</label>
        <textarea
          id="adresse"
          placeholder="Votre adresse compl√®te"
          required
        ></textarea>

        <button type="submit">Envoyer via WhatsApp</button>
        <button type="button" class="secondary-btn" onclick="envoyerParEmail()">
          ‚úâÔ∏è Envoyer par Email
        </button>
        <h1>Mon produit</h1>
        <p>15 ‚Ç¨</p>
        <a href="https://buy.stripe.com/test_eVq7sE7Gk0Ue6iwacj4gg00" target="_blank">
          <button>Acheter maintenant</button>
        </a>
      </form>
    </div>

    <script>
      const panier = JSON.parse(localStorage.getItem("panier")) || [];

      // Validation du formulaire avant soumission
      document
        .getElementById("commandeForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const nom = document.getElementById("nom").value;
          const email = document.getElementById("email").value;
          const tel = document.getElementById("tel").value;
          const adresse = document.getElementById("adresse").value;

          if (!nom || !email || !tel || !adresse) {
            alert("Veuillez remplir tous les champs !");
            return;
          }

          let message = `Nouvelle commande ! üëá\n\nüë§ Nom : ${nom}\nüìß Email : ${email}\nüìû T√©l√©phone : ${tel}\nüè° Adresse : ${adresse}\n\nüõí Produits command√©s :\n`;
          let total = 0;
          panier.forEach((p) => {
            message += `- ${p.nom} : ${p.prix} ‚Ç¨\n`;
            total += p.prix;
          });
          message += `\nüí∞ Total : ${total.toFixed(2)} ‚Ç¨`;

          const numeroWhatsApp = "33752224585";
          const url = `https://wa.me/${numeroWhatsApp}?text=${encodeURIComponent(
            message
          )}`;
          window.open(url, "_blank");
        });

      // Fonction pour envoyer par Email
      function envoyerParEmail() {
        const nom = document.getElementById("nom").value;
        const email = document.getElementById("email").value;
        const tel = document.getElementById("tel").value;
        const adresse = document.getElementById("adresse").value;

        if (!nom || !email || !tel || !adresse) {
          alert("Veuillez remplir tous les champs !");
          return;
        }

        let message = `Nouvelle commande par Email ! üëá\n\nüë§ Nom : ${nom}\nüìß Email : ${email}\nüìû T√©l√©phone : ${tel}\nüè° Adresse : ${adresse}\n\nüõí Produits command√©s :\n`;
        let total = 0;
        panier.forEach((p) => {
          message += `- ${p.nom} : ${p.prix} ‚Ç¨\n`;
          total += p.prix;
        });
        message += `\nüí∞ Total : ${total.toFixed(2)} ‚Ç¨`;

        const subject = "Nouvelle commande - √âl√©gance Sacr√©e";
        const mailtoLink = `mailto:kaoutar_bilal@hotmail.fr?subject=${encodeURIComponent(
          subject
        )}&body=${encodeURIComponent(message)}`;
        window.location.href = mailtoLink;
      }
    </script>
  </body>
</html>
